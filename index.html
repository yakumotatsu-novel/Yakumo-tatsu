<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>八雲立つ Beneath the Rising Clouds</title>
<link rel="icon" href="data:,">
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body{background:#fafaf9;color:#111827}
  .card{border:1px solid #e5e7eb;border-radius:1rem;background:#fff}
  .line-clamp-2{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  .badge{border:1px solid #e5e7eb;border-radius:9999px;padding:.1rem .5rem;font-size:.75rem}
  .cover{aspect-ratio:3/4;object-fit:cover;border-radius:.75rem;border:1px solid #e5e7eb;width:100%}
</style>
</head>
<body class="antialiased">

<header class="sticky top-0 bg-white/80 backdrop-blur border-b">
  <div class="max-w-6xl mx-auto px-4 h-16 flex items-center gap-3">
    <h1 class="font-bold text-lg">小説サイト</h1>
    <div class="ml-auto flex gap-2">
      <input id="q" class="border rounded px-3 py-1.5 w-56" placeholder="作品名・作者・紹介で検索">
      <select id="tag" class="border rounded px-3 py-1.5">
        <option value="">すべてのタグ</option>
      </select>
      <select id="sort" class="border rounded px-3 py-1.5">
        <option value="updated_desc">更新が新しい順</option>
        <option value="title_asc">タイトル順</option>
        <option value="author_asc">作者順</option>
      </select>
    </div>
  </div>
</header>

<main class="max-w-6xl mx-auto px-4 py-6">
  <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
</main>

<footer class="max-w-6xl mx-auto px-4 py-10 border-t text-sm text-zinc-500">
  © 2025
</footer>

<script>
// ====== 作品データ（ここを書き換えるだけでOK） ==================================
const WORKS = [
  {
    slug: "wagahai",                         // 読むページの識別子（reader.html?work=wagahai など）
    title: "吾輩は猫である",
    author: "夏目漱石",
    summary: "猫の視点から人間社会を描いた風刺的長編。",
    cover: "https://picsum.photos/seed/cat/600/800", // 画像URL（なければ空に）
    tags: ["古典","ユーモア"],
    updated: "2025-08-15",
    chapters: 10
  },
  {
    slug: "kokoro",
    title: "こころ",
    author: "夏目漱石",
    summary: "「私」「先生」「遺書」の三部構成で人間の内面を描く。",
    cover: "https://picsum.photos/seed/heart/600/800",
    tags: ["古典","心理"],
    updated: "2025-07-30",
    chapters: 15
  },
  {
    slug: "original-001",
    title: "雨の街灯",
    author: "Riku",
    summary: "雨に濡れた街角で交錯する三人の視線の物語。",
    cover: "",
    tags: ["現代","短編"],
    updated: "2025-06-12",
    chapters: 5
  }
];
// ===================================================================================

// タグプルダウン初期化
const tagSet = new Set();
WORKS.forEach(w => (w.tags||[]).forEach(t => tagSet.add(t)));
const tagSel = document.getElementById('tag');
[...tagSet].sort().forEach(t=>{
  const o = document.createElement('option'); o.value=t; o.textContent=t; tagSel.appendChild(o);
});

// レンダリング
const grid = document.getElementById('grid');
const q = document.getElementById('q');
const sortSel = document.getElementById('sort');

function render(){
  const query = (q.value||"").trim().toLowerCase();
  const tag = tagSel.value;

  let list = WORKS.filter(w=>{
    const hay = [w.title,w.author,w.summary,(w.tags||[]).join(" ")].join(" ").toLowerCase();
    const okQ = !query || hay.includes(query);
    const okT = !tag || (w.tags||[]).includes(tag);
    return okQ && okT;
  });

  switch (sortSel.value){
    case 'title_asc':  list.sort((a,b)=>a.title.localeCompare(b.title,'ja')); break;
    case 'author_asc': list.sort((a,b)=>a.author.localeCompare(b.author,'ja')); break;
    default: // updated_desc
      list.sort((a,b)=> new Date(b.updated) - new Date(a.updated)); break;
  }

  grid.innerHTML = list.map(w=>`
    <article class="card p-4 flex flex-col gap-3">
      <a href="reader.html?work=${encodeURIComponent(w.slug)}" class="block">
        ${w.cover ? `<img class="cover" src="${w.cover}" alt="${w.title}">` :
        `<div class="cover grid place-items-center text-zinc-400">No Image</div>`}
      </a>
      <div class="flex items-start justify-between gap-3">
        <div>
          <h3 class="font-semibold text-lg leading-tight">
            <a class="hover:opacity-80" href="reader.html?work=${encodeURIComponent(w.slug)}">${w.title}</a>
          </h3>
          <div class="text-sm text-zinc-600">${w.author}</div>
        </div>
        <div class="text-xs text-zinc-500 whitespace-nowrap">更新: ${w.updated}</div>
      </div>
      <p class="text-sm text-zinc-700 line-clamp-2">${w.summary}</p>
      <div class="flex flex-wrap gap-2">
        ${(w.tags||[]).map(t=>`<span class="badge">${t}</span>`).join('')}
        <span class="badge">全${w.chapters}章</span>
      </div>
      <div class="mt-2">
        <a class="inline-block border rounded px-3 py-1 hover:bg-zinc-50 text-sm"
           href="reader.html?work=${encodeURIComponent(w.slug)}">読む</a>
      </div>
    </article>
  `).join('');

  if (!list.length){
    grid.innerHTML = `<div class="text-zinc-500">一致する作品がありません。</div>`;
  }
}

q.addEventListener('input', render);
tagSel.addEventListener('change', render);
sortSel.addEventListener('change', render);
render();
</script>
</body>
</html>
